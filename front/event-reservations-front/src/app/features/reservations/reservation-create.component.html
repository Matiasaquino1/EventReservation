<section class="reservation-wrapper">
  @if (loading()) {
    <p class="loading">Cargando detalles del evento...</p>
  } @else if (event(); as ev) {
    <div class="container">
      <header>
        <h1>Confirmar Reserva</h1>
        <p class="event-title">{{ ev.title }}</p>
      </header>

      <div class="meta">
        <p>ğŸ“ {{ ev.location }}</p>
        <p>ğŸ“… {{ ev.eventDate | date:'fullDate' }}</p>
      </div>

      <div class="booking-card">
        <div class="details">
          <div class="info-group">
            <span class="label">Precio unitario</span>
            <p class="price">$ {{ ev.price | number:'1.0-0' }}</p>
          </div>
          <div class="info-group">
            <span class="label">Disponibles</span>
            <p class="stock">{{ ev.ticketsAvailable }} ğŸŸï¸</p>
          </div>
        </div>

        <div class="field-container">
          <label for="tickets">Â¿CuÃ¡ntas entradas deseas?</label>
          <input
            id="tickets"
            type="number"
            [(ngModel)]="numberOfTickets"
            [max]="ev.ticketsAvailable"
            min="1"
            class="ticket-input">
        </div>

        <div class="total-section">
          <span>Total a pagar</span>
          <p class="total-amount">$ {{ totalPrice() | number:'1.0-0' }}</p>
        </div>

        <button
          class="btn-confirm"
          (click)="reserve()"
          [disabled]="ev.ticketsAvailable === 0 || numberOfTickets() < 1">
          Finalizar Reserva
        </button>
      </div>

      @if (!authService.currentUser) {
        <p class="hint">âš ï¸ Debes iniciar sesiÃ³n antes de reservar.</p>
      }
      
      @if (error()) {
        <p class="error-msg">{{ error() }}</p>
      }
    </div>
  } @else {
    <div class="container error-state">
      <p>Hubo un problema al cargar el evento.</p>
      <button (click)="router.navigate(['/'])">Volver al inicio</button>
    </div>
  }
</section>
